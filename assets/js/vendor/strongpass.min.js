(function(){"use strict";var e=new Class({Implements:[Options,Events],options:{minChar:6,passIndex:2,label:"Password strength: ",verdicts:["Too Short","Very weak","Weak","Good","Strong","Very strong"],colors:["#ccc","#500","#800","#f60","#050","#0f0"],width:["0%","10%","30%","60%","80%","100%"],scores:[10,15,25,45],bannedPass:"Not allowed",passStrengthZen:"div.pass-container",passbarClassZen:"div.pass-bar",passbarHintZen:"div.pass-hint",render:!0,injectTarget:null,injectPlacement:"after"},bannedPasswords:["123456","12345","123456789","password","iloveyou","princess","rockyou","1234567","12345678","abc123","nicole","daniel","babygirl","monkey","jessica","lovely","michael","ashley","654321","qwerty","password1","welcome","welcome1","password2","password01","password3","p@ssw0rd","passw0rd","password4","password123","summer09","password6","password7","password9","password8","welcome2","welcome01","winter12","spring2012","summer12","summer2012"],initialize:function(e,s){this.setOptions(s),this.element=document.id(e),this.options.render&&this.createBox(),this.attachEvents(),this.fireEvent("ready")},attachEvents:function(){return this.eventObj&&this.element.removeEvents(this.eventObj),this.element.addEvents(this.eventObj={keyup:this.runPassword.bind(this)}),this},createBox:function(){var e=this.element.getSize().x,s=this.options;return this.stbox=new Element(s.passStrengthZen,{styles:{width:e}}),this.stdbar=new Element(s.passbarClassZen,{styles:{width:e-2}}).inject(this.stbox),this.txtbox=new Element(s.passbarHintZen).inject(this.stbox),this.stbox.inject(document.id(s.injectTarget)||this.element,s.injectPlacement),this},runPassword:function(e,s){s=s||this.element.get("value");var t,n=this.checkPassword(s),r=0,i=this.options,a=Array.clone(i.scores);return-1!==Array.indexOf(this.bannedPasswords,s.toLowerCase())?(this.fireEvent("banned",s),t=i.bannedPass):(0>n&&n>-199?r=0:(a.push(n),a.sort(function(e,s){return e-s}),r=a.indexOf(n)+1),t=i.verdicts[r]||i.verdicts.getLast()),i.render&&(this.txtbox.set("text",[i.label,t].join("")),this.stdbar.setStyles({width:i.width[r]||i.width.getLast(),background:i.colors[r]||i.colors.getLast()})),this.fireEvent(["fail","pass"][+(this.passed=i.verdicts.indexOf(t)>=i.passIndex)],[r,t,s])},checks:[{re:/[a-z]/,score:1},{re:/[A-Z]/,score:5},{re:/([a-z].*[A-Z])|([A-Z].*[a-z])/,score:2},{re:/(.*[0-9].*[0-9].*[0-9])/,score:7},{re:/.[!@#$%^&*?_~]/,score:5},{re:/(.*[!@#$%^&*?_~].*[!@#$%^&*?_~])/,score:7},{re:/([a-zA-Z0-9].*[!@#$%^&*?_~])|([!@#$%^&*?_~].*[a-zA-Z0-9])/,score:3},{re:/(.)\1+$/,score:2}],checkPassword:function(e){var s=0,t=this.options.minChar,n=e.length,r=n-t;return 0>r&&(s-=100)||r>=5&&(s+=18)||r>=3&&(s+=12)||2===r&&(s+=6),Array.each(this.checks,function(t){e.match(t.re)&&(s+=t.score)}),s&&(s+=n),s}});"function"==typeof define&&define.amd?define(function(){return e}):this.StrongPass=e}).call(this);